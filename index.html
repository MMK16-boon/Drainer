<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Airdrop Claim Portal</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

  <!-- WalletConnect & Ethers.js -->
  <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.6.2/dist/ethers.umd.min.js"></script>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      margin: 0; padding: 0;
      display: flex; height: 100vh;
      align-items: center; justify-content: center;
      color: white;
    }
    .card {
      background: rgba(255,255,255,0.08);
      padding: 2rem; border-radius: 12px;
      max-width: 400px; width: 90%;
      text-align: center;
      box-shadow: 0 0 30px rgba(0,0,0,0.3);
    }
    h1 { margin-bottom: 0.5rem; color: #00ffae; }
    p { opacity: 0.9; margin-bottom: 1.5rem; }
    .amount {
      font-size: 2rem; font-weight: bold;
      margin-bottom: 1.5rem; color: #00ffae;
    }
    button {
      background: #00ffae; color: #000;
      border: none; padding: 12px 24px;
      font-weight: 600; border-radius: 8px;
      cursor: pointer; margin: 0.5rem;
      transition: background 0.3s;
    }
    button:hover { background: #00c98e; }
    #status { margin-top: 1rem; font-size: 0.9rem; color: #ffb74d; }
    .footer { margin-top: 2rem; font-size: 0.8rem; color: #ccc; }
  </style>
</head>
<body>

  <div class="card">
    <h1>üéâ Airdrop Claim Portal</h1>
    <p>Connect your wallet to verify eligibility and claim your airdrop rewards.</p>
    <div class="amount">üí∞ 1,000 </div>

    <button onclick="connectWallet()">Connect Wallet</button>
    <button onclick="claimAirdrop()">Claim Airdrop</button>
    <div id="status">Wallet not connected.</div>
    <div class="footer">¬© 2025 Airdrop Distribution</div>
  </div>

  <script>
    // üöÄ Contract details
    const CONTRACT_ADDRESS = "0x7EA0416fC7b242a040177DD6257a68E4fFad1E30"; // Sepolia
    const ABI = [
      {"inputs":[],"name":"claimAirdrop","outputs":[],"stateMutability":"nonpayable","type":"function"},
      {"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"hasClaimed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"}
    ];

    let provider, signer, contract;
    const statusEl = document.getElementById("status");

    async function connectWallet() {
      try {
        // 1Ô∏è‚É£ Injected wallets
        if (window.ethereum && (window.ethereum.isMetaMask || window.ethereum.isTrust || window.ethereum.isRainbow || window.ethereum.isCoinbaseWallet)) {
          provider = window.ethereum;
          await provider.request({ method: "eth_requestAccounts" });
        } else {
          // 2Ô∏è‚É£ WalletConnect fallback
          const wcProvider = new window.WalletConnectProvider.default({
            rpc: {
              11155111: "https://sepolia.infura.io/v3/0231e84c2a6a435b8f0e7ec4d2fa7723",
              1: "https://mainnet.infura.io/v3/0231e84c2a6a435b8f0e7ec4d2fa7723"
            },
            qrcodeModalOptions: {
              mobileLinks: ["metamask","trust","rainbow","argent","imtoken","pillar"]
            }
          });
          await wcProvider.enable();
          provider = wcProvider;
        }

        // Wrap in Ethers.js
        const ethersProvider = new ethers.BrowserProvider(provider);
        signer = await ethersProvider.getSigner();
        const address = await signer.getAddress();
        contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);

        statusEl.innerText = `‚úÖ Connected: ${address.slice(0,6)}‚Ä¶${address.slice(-4)}`;
      } catch (e) {
        console.error(e);
        statusEl.innerText = "‚ùå Connection failed. Please try again.";
      }
    }

    async function claimAirdrop() {
      if (!contract) {
        statusEl.innerText = "‚ùå Connect wallet first.";
        return;
      }
      try {
        // Check if already claimed
        const claimed = await contract.hasClaimed(await signer.getAddress());
        if (claimed) {
          statusEl.innerText = "‚ùå You have already claimed.";
          return;
        }
        const tx = await contract.claimAirdrop();
        statusEl.innerText = "‚è≥ Waiting for confirmation...";
        await tx.wait();
        statusEl.innerText = "üéâ Airdrop claimed!";
      } catch (e) {
        console.error(e);
        statusEl.innerText = "‚ùå Claim failed or rejected.";
      }
    }
  </script>
</body>
</html>